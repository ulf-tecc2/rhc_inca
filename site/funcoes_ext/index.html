
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../transformacoes/">
      
      
        <link rel="next" href="../gerar_indicadores/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.27">
    
    
      
        <title>Extracao e Selecao de Dados - Registros Hospitalares de Câncer (RHC)</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.6543a935.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#extracaoDados" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Registros Hospitalares de Câncer (RHC)" class="md-header__button md-logo" aria-label="Registros Hospitalares de Câncer (RHC)" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Registros Hospitalares de Câncer (RHC)
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Extracao e Selecao de Dados
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
      <div class="md-header__source">
        <a href="https://github.com/ulf-tecc2/rhc_inca.git" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Registros Hospitalares de Câncer (RHC)" class="md-nav__button md-logo" aria-label="Registros Hospitalares de Câncer (RHC)" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Registros Hospitalares de Câncer (RHC)
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ulf-tecc2/rhc_inca.git" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../funcoes_pre/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pre Processamento e Carga de Dados
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../funcoes_ana/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Analise de Dados
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../transformacoes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transformacoes dos Dados
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Extracao e Selecao de Dados
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Extracao e Selecao de Dados
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#extracaoDados" class="md-nav__link">
    <span class="md-ellipsis">
      extracaoDados
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extracaoDados--roteiro-de-execucao" class="md-nav__link">
    <span class="md-ellipsis">
      Roteiro de execucao:
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extracaoDados.elimina_sem_tratamento" class="md-nav__link">
    <span class="md-ellipsis">
      elimina_sem_tratamento
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extracaoDados.main" class="md-nav__link">
    <span class="md-ellipsis">
      main
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extracaoDados.remover_colunas_naosignificativas" class="md-nav__link">
    <span class="md-ellipsis">
      remover_colunas_naosignificativas
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extracaoDados.seleciona_DATAS" class="md-nav__link">
    <span class="md-ellipsis">
      seleciona_DATAS
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extracaoDados.seleciona_ESTADIAM" class="md-nav__link">
    <span class="md-ellipsis">
      seleciona_ESTADIAM
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extracaoDados.seleciona_ESTDFIMT" class="md-nav__link">
    <span class="md-ellipsis">
      seleciona_ESTDFIMT
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extracaoDados.seleciona_TNM" class="md-nav__link">
    <span class="md-ellipsis">
      seleciona_TNM
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extracaoDados.seleciona_naonulos" class="md-nav__link">
    <span class="md-ellipsis">
      seleciona_naonulos
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../gerar_indicadores/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Geracao de Indicadores
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#extracaoDados" class="md-nav__link">
    <span class="md-ellipsis">
      extracaoDados
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extracaoDados--roteiro-de-execucao" class="md-nav__link">
    <span class="md-ellipsis">
      Roteiro de execucao:
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extracaoDados.elimina_sem_tratamento" class="md-nav__link">
    <span class="md-ellipsis">
      elimina_sem_tratamento
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extracaoDados.main" class="md-nav__link">
    <span class="md-ellipsis">
      main
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extracaoDados.remover_colunas_naosignificativas" class="md-nav__link">
    <span class="md-ellipsis">
      remover_colunas_naosignificativas
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extracaoDados.seleciona_DATAS" class="md-nav__link">
    <span class="md-ellipsis">
      seleciona_DATAS
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extracaoDados.seleciona_ESTADIAM" class="md-nav__link">
    <span class="md-ellipsis">
      seleciona_ESTADIAM
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extracaoDados.seleciona_ESTDFIMT" class="md-nav__link">
    <span class="md-ellipsis">
      seleciona_ESTDFIMT
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extracaoDados.seleciona_TNM" class="md-nav__link">
    <span class="md-ellipsis">
      seleciona_TNM
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extracaoDados.seleciona_naonulos" class="md-nav__link">
    <span class="md-ellipsis">
      seleciona_naonulos
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>Extracao e Selecao de Dados</h1>

<div class="doc doc-object doc-module">



<a id="extracaoDados"></a>
    <div class="doc doc-contents first">

      <p>Registros Hospitalares de Câncer (RHC) - Extracao e selecao dos dados para construcao dos modelos.</p>
<p>MBA em Data Science e Analytics - USP/Esalq - 2025</p>
<p>@author: Ulf Bergmann</p>
<h2 id="extracaoDados--roteiro-de-execucao">Roteiro de execucao:</h2>
<pre><code>1. Elimina registros sem tratamento 
2. Elimina registros com ESTDFIMT nao validos
3. Elimina registros com ESTADIAM  nao validos
4. Elimina registros com TNM nao validos
5. Elimina registros com DATAS  nao validos
6. Elimina registros com SEXO ou TIPOHIST nulos
7. Elimina registros de casos nao analiticos
8. Remove colunas nao significantes
10. Salvar o arquivo como parquet
</code></pre>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="extracaoDados.elimina_sem_tratamento" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">elimina_sem_tratamento</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

      <p>Elimina os registros de quem nao fez tratamento (RZNTR de 1 ate 7).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>df</code></td>
            <td>
                  <code>DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame a ser transformado / analisado</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>df modificado</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>Dictionary</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict com indicadores</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>extracaoDados.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">elimina_sem_tratamento</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Elimina os registros de quem nao fez tratamento (RZNTR de 1 ate 7).</span>

<span class="sd">    Parameters:</span>
<span class="sd">        df (DataFrame): DataFrame a ser transformado / analisado</span>


<span class="sd">    Returns:</span>
<span class="sd">        (DataFrame): df modificado</span>
<span class="sd">        (Dictionary):  dict com indicadores</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">q_inicial</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span> <span class="p">,</span> <span class="s1">&#39;3&#39;</span> <span class="p">,</span> <span class="s1">&#39;4&#39;</span> <span class="p">,</span> <span class="s1">&#39;5&#39;</span> <span class="p">,</span> <span class="s1">&#39;6&#39;</span> <span class="p">,</span> <span class="s1">&#39;7&#39;</span><span class="p">]</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">df_base</span><span class="p">[</span><span class="n">df_base</span><span class="p">[</span><span class="s1">&#39;RZNTR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">values</span><span class="p">)]</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>

    <span class="n">a_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">a_dict</span><span class="p">[</span><span class="s1">&#39;RZNTR&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">q_inicial</span> <span class="o">-</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">log</span><span class="o">.</span><span class="n">logar_acao_realizada</span><span class="p">(</span><span class="s1">&#39;Selecao Dados&#39;</span> <span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Eliminacao dos registros de quem nao fez tratamento (RZNTR nao nulo)&#39;</span> <span class="p">,</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">q_inicial</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">))</span>
    <span class="n">log</span><span class="o">.</span><span class="n">logar_indicador</span><span class="p">(</span><span class="s1">&#39;Extracao&#39;</span> <span class="p">,</span> <span class="s1">&#39;Eliminar Dados&#39;</span>  <span class="p">,</span> <span class="s1">&#39;Eliminacao dos registros de quem nao fez tratamento (RZNTR nao nulo)&#39;</span> <span class="p">,</span> <span class="s1">&#39;RZNTR&#39;</span> <span class="p">,</span> <span class="n">q_inicial</span> <span class="o">-</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span>

    <span class="k">return</span> <span class="n">df</span> <span class="p">,</span>  <span class="n">a_dict</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="extracaoDados.main" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">main</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

      <p>Funcao principal.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>df</code></td>
            <td>
                  <code>DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame a ser transformado / analisado</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
      <p>Returns:
    (DataFrame): df modificado   <br />
    (DataFrame): df indicadores</p>

            <details class="quote">
              <summary>Source code in <code>extracaoDados.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Funcao principal.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        df (DataFrame): DataFrame a ser transformado / analisado</span>
<span class="sd">    Returns:</span>
<span class="sd">        (DataFrame): df modificado     </span>
<span class="sd">        (DataFrame): df indicadores    </span>
<span class="sd">    &quot;&quot;&quot;</span> 
    <span class="n">a_dict</span> <span class="o">=</span> <span class="p">{}</span>


    <span class="n">df</span> <span class="p">,</span> <span class="n">aux_dict</span> <span class="o">=</span> <span class="n">elimina_sem_tratamento</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="n">a_dict</span> <span class="o">=</span> <span class="n">a_dict</span> <span class="o">|</span> <span class="n">aux_dict</span>

    <span class="n">df</span> <span class="p">,</span> <span class="n">aux_dict</span> <span class="o">=</span> <span class="n">seleciona_ESTDFIMT</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="n">a_dict</span> <span class="o">=</span> <span class="n">a_dict</span> <span class="o">|</span> <span class="n">aux_dict</span>

    <span class="n">df</span> <span class="p">,</span> <span class="n">aux_dict</span> <span class="o">=</span> <span class="n">seleciona_ESTADIAM</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="n">a_dict</span> <span class="o">=</span> <span class="n">a_dict</span> <span class="o">|</span> <span class="n">aux_dict</span>

    <span class="n">df</span> <span class="p">,</span> <span class="n">aux_dict</span> <span class="o">=</span> <span class="n">seleciona_TNM</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="n">a_dict</span> <span class="o">=</span> <span class="n">a_dict</span> <span class="o">|</span> <span class="n">aux_dict</span>

    <span class="n">df</span> <span class="p">,</span> <span class="n">aux_dict</span> <span class="o">=</span> <span class="n">seleciona_DATAS</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="n">a_dict</span> <span class="o">=</span> <span class="n">a_dict</span> <span class="o">|</span> <span class="n">aux_dict</span>

    <span class="n">df</span> <span class="p">,</span> <span class="n">aux_dict</span> <span class="o">=</span> <span class="n">seleciona_naonulos</span><span class="p">(</span><span class="n">df</span> <span class="p">,</span> <span class="n">lista_variaveis</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;SEXO&#39;</span> <span class="p">,</span> <span class="s1">&#39;TIPOHIST&#39;</span><span class="p">])</span>    
    <span class="n">a_dict</span> <span class="o">=</span> <span class="n">a_dict</span> <span class="o">|</span> <span class="n">aux_dict</span>

    <span class="n">q_inicial</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;TPCASO&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;1&#39;</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">log</span><span class="o">.</span><span class="n">logar_acao_realizada</span><span class="p">(</span><span class="s1">&#39;Selecao Dados&#39;</span> <span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Eliminacao dos registros nao analiticos&#39;</span> <span class="p">,</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">q_inicial</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">))</span>


    <span class="n">df</span> <span class="o">=</span> <span class="n">remover_colunas_naosignificativas</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

    <span class="n">an_ind_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">a_dict</span><span class="p">])</span>
    <span class="n">an_ind_df</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int64&#39;</span><span class="p">)</span>
    <span class="n">an_ind_df</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Indicador&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Registros eliminados na seleção dos dados&#39;</span><span class="p">])</span>


    <span class="k">return</span> <span class="n">df</span> <span class="p">,</span> <span class="n">an_ind_df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="extracaoDados.remover_colunas_naosignificativas" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">remover_colunas_naosignificativas</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

      <p>Elimina as variaveis (colunas) que nao possuem significancia .</p>


<details class="colunas" open>
  <summary>Colunas</summary>
  <p>'ESTDFIMT', 'RZNTR','DTDIAGNO' , 'DTTRIAGE' , 'DATAPRICON' , 'DATAINITRT' , 'DATAOBITO', 
'TPCASO', 'LOCALNAS' , 'BASDIAGSP' , 'VALOR_TOT' , 
'AnaliseLOCTUDET', 'AnaliseLOCTUDET_tipo', 'AnaliseLOCTUPRI', 'AnaliseLOCTUPRO','AnaliseTNM', 'AnaliseESTADIAM' ,
'CLIATEN' , 'CLITRAT' , 'CNES' , 'DTINITRT' , 'LOCTUPRO' , 'ESTADRES', 'OUTROESTA' , 'OCUPACAO' , 'PROCEDEN' , 'ESTADIAG'</p>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>df</code></td>
            <td>
                  <code>DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame a ser transformado / analisado</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>df modificado</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>extracaoDados.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">remover_colunas_naosignificativas</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Elimina as variaveis (colunas) que nao possuem significancia .</span>

<span class="sd">    Colunas:</span>
<span class="sd">        &#39;ESTDFIMT&#39;, &#39;RZNTR&#39;,&#39;DTDIAGNO&#39; , &#39;DTTRIAGE&#39; , &#39;DATAPRICON&#39; , &#39;DATAINITRT&#39; , &#39;DATAOBITO&#39;, </span>
<span class="sd">        &#39;TPCASO&#39;, &#39;LOCALNAS&#39; , &#39;BASDIAGSP&#39; , &#39;VALOR_TOT&#39; , </span>
<span class="sd">        &#39;AnaliseLOCTUDET&#39;, &#39;AnaliseLOCTUDET_tipo&#39;, &#39;AnaliseLOCTUPRI&#39;, &#39;AnaliseLOCTUPRO&#39;,&#39;AnaliseTNM&#39;, &#39;AnaliseESTADIAM&#39; ,</span>
<span class="sd">        &#39;CLIATEN&#39; , &#39;CLITRAT&#39; , &#39;CNES&#39; , &#39;DTINITRT&#39; , &#39;LOCTUPRO&#39; , &#39;ESTADRES&#39;, &#39;OUTROESTA&#39; , &#39;OCUPACAO&#39; , &#39;PROCEDEN&#39; , &#39;ESTADIAG&#39;</span>

<span class="sd">    Parameters:</span>
<span class="sd">        df (DataFrame): DataFrame a ser transformado / analisado</span>

<span class="sd">    Returns:</span>
<span class="sd">        (DataFrame): df modificado</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">#remocao de variaveis nao significativas</span>
    <span class="n">colunas_a_remover</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ESTDFIMT&#39;</span><span class="p">,</span> <span class="s1">&#39;RZNTR&#39;</span><span class="p">,</span><span class="s1">&#39;DTDIAGNO&#39;</span> <span class="p">,</span> <span class="s1">&#39;DTTRIAGE&#39;</span> <span class="p">,</span> <span class="s1">&#39;DATAPRICON&#39;</span> <span class="p">,</span> <span class="s1">&#39;DATAINITRT&#39;</span> <span class="p">,</span> <span class="s1">&#39;DATAOBITO&#39;</span><span class="p">,</span> <span class="s1">&#39;RZNTR&#39;</span> <span class="p">,</span>
                         <span class="s1">&#39;TPCASO&#39;</span><span class="p">,</span> <span class="s1">&#39;LOCALNAS&#39;</span> <span class="p">,</span> <span class="s1">&#39;BASDIAGSP&#39;</span> <span class="p">,</span> <span class="s1">&#39;VALOR_TOT&#39;</span> <span class="p">,</span> 
                         <span class="s1">&#39;AnaliseLOCTUDET&#39;</span><span class="p">,</span> <span class="s1">&#39;AnaliseLOCTUDET_tipo&#39;</span><span class="p">,</span> <span class="s1">&#39;AnaliseLOCTUPRI&#39;</span><span class="p">,</span> <span class="s1">&#39;AnaliseLOCTUPRO&#39;</span><span class="p">,</span><span class="s1">&#39;AnaliseTNM&#39;</span><span class="p">,</span> <span class="s1">&#39;AnaliseESTADIAM&#39;</span> <span class="p">,</span>
                         <span class="s1">&#39;CLIATEN&#39;</span> <span class="p">,</span> <span class="s1">&#39;CLITRAT&#39;</span> <span class="p">,</span> <span class="s1">&#39;CNES&#39;</span> <span class="p">,</span> <span class="s1">&#39;DTINITRT&#39;</span> <span class="p">,</span> <span class="s1">&#39;LOCTUPRO&#39;</span> <span class="p">,</span> <span class="s1">&#39;ESTADRES&#39;</span><span class="p">,</span> <span class="s1">&#39;OUTROESTA&#39;</span> <span class="p">,</span> <span class="s1">&#39;OCUPACAO&#39;</span> <span class="p">,</span> <span class="s1">&#39;PROCEDEN&#39;</span> <span class="p">,</span> <span class="s1">&#39;ESTADIAG&#39;</span> <span class="p">]</span>

    <span class="n">df_aux</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">colunas_a_remover</span> <span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">log</span><span class="o">.</span><span class="n">logar_acao_realizada</span><span class="p">(</span><span class="s1">&#39;Selecao Dados&#39;</span> <span class="p">,</span> <span class="s1">&#39;Eliminacao de colunas com dados sem significancia&#39;</span> <span class="p">,</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">colunas_a_remover</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">df_aux</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="extracaoDados.seleciona_DATAS" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">seleciona_DATAS</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

      <p>Selecao de datas () nao nulas.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>df</code></td>
            <td>
                  <code>DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame a ser transformado / analisado</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>df modificado</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>Dictionary</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict com indicadores</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>extracaoDados.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">seleciona_DATAS</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Selecao de datas () nao nulas.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        df (DataFrame): DataFrame a ser transformado / analisado</span>


<span class="sd">    Returns:</span>
<span class="sd">        (DataFrame): df modificado</span>
<span class="sd">        (Dictionary):  dict com indicadores</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a_dict</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">q_inicial</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1">#retirar valores que nao sao exatos</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DATAINITRT&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">a_dict</span><span class="p">[</span><span class="s1">&#39;DATAINITRT&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">q_inicial</span> <span class="o">-</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">log</span><span class="o">.</span><span class="n">logar_acao_realizada</span><span class="p">(</span><span class="s1">&#39;Selecao Dados&#39;</span> <span class="p">,</span> <span class="s1">&#39;Eliminacao de registros com DATAINITRT nulo&#39;</span> <span class="p">,</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">q_inicial</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">))</span>
    <span class="n">log</span><span class="o">.</span><span class="n">logar_indicador</span><span class="p">(</span><span class="s1">&#39;Extracao&#39;</span> <span class="p">,</span> <span class="s1">&#39;Eliminar Dados&#39;</span>  <span class="p">,</span> <span class="s1">&#39;Eliminacao de registros com DATAINITRT nulo&#39;</span> <span class="p">,</span> <span class="s1">&#39;DATAINITRT&#39;</span> <span class="p">,</span> <span class="n">q_inicial</span> <span class="o">-</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span>

    <span class="c1"># remover sem data de diagnostico</span>
    <span class="n">q_inicial</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1">#retirar valores que nao sao exatos</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DTDIAGNO&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">a_dict</span><span class="p">[</span><span class="s1">&#39;DTDIAGNO&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">q_inicial</span> <span class="o">-</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">log</span><span class="o">.</span><span class="n">logar_acao_realizada</span><span class="p">(</span><span class="s1">&#39;Selecao Dados&#39;</span> <span class="p">,</span> <span class="s1">&#39;Eliminacao de registros com DTDIAGNO nulo&#39;</span> <span class="p">,</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">q_inicial</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">))</span>
    <span class="n">log</span><span class="o">.</span><span class="n">logar_indicador</span><span class="p">(</span><span class="s1">&#39;Extracao&#39;</span> <span class="p">,</span> <span class="s1">&#39;Eliminar Dados&#39;</span>  <span class="p">,</span> <span class="s1">&#39;Eliminacao de registros com DTDIAGNO nulo&#39;</span> <span class="p">,</span> <span class="s1">&#39;DTDIAGNO&#39;</span> <span class="p">,</span> <span class="n">q_inicial</span> <span class="o">-</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span>

    <span class="k">return</span> <span class="n">df</span> <span class="p">,</span> <span class="n">a_dict</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="extracaoDados.seleciona_ESTADIAM" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">seleciona_ESTADIAM</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

      <p>Elimina os valores invalidos ou nulos de ESTADIAM.</p>
<p>ESTADIAM = codificação do grupamento do estádio clínico segundo classificação TNM</p>


<details class="regras" open>
  <summary>Regras</summary>
  <p>AnaliseESTADIAM ==&gt;&gt; nulo | demais  ===&gt;&gt;&gt; ELIMINAR</p>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>df</code></td>
            <td>
                  <code>DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame a ser transformado / analisado</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>df modificado</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>Dictionary</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict com indicadores</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>extracaoDados.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">seleciona_ESTADIAM</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Elimina os valores invalidos ou nulos de ESTADIAM.</span>

<span class="sd">    ESTADIAM = codificação do grupamento do estádio clínico segundo classificação TNM</span>

<span class="sd">    Regras:</span>
<span class="sd">        AnaliseESTADIAM ==&gt;&gt; nulo | demais  ===&gt;&gt;&gt; ELIMINAR</span>

<span class="sd">    Parameters:</span>
<span class="sd">        df (DataFrame): DataFrame a ser transformado / analisado</span>

<span class="sd">    Returns:</span>
<span class="sd">        (DataFrame): df modificado</span>
<span class="sd">        (Dictionary):  dict com indicadores</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">q_inicial</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1">#retirar valores que nao sao exatos</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;AnaliseESTADIAM&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;nulo&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;AnaliseESTADIAM&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;demais&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>

    <span class="n">a_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">a_dict</span><span class="p">[</span><span class="s1">&#39;ESTADIAM&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">q_inicial</span> <span class="o">-</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">log</span><span class="o">.</span><span class="n">logar_acao_realizada</span><span class="p">(</span><span class="s1">&#39;Selecao Dados&#39;</span> <span class="p">,</span> <span class="s1">&#39;Eliminacao de registros com ESTADIAM que nao sao exatos&#39;</span> <span class="p">,</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">q_inicial</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">))</span>
    <span class="n">log</span><span class="o">.</span><span class="n">logar_indicador</span><span class="p">(</span><span class="s1">&#39;Extracao&#39;</span> <span class="p">,</span> <span class="s1">&#39;Eliminar Dados&#39;</span>  <span class="p">,</span> <span class="s1">&#39;Eliminacao de registros com ESTADIAM fora do padrao ou nulos&#39;</span> <span class="p">,</span> <span class="s1">&#39;ESTADIAM&#39;</span> <span class="p">,</span> <span class="n">q_inicial</span> <span class="o">-</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span>

    <span class="k">return</span> <span class="n">df</span> <span class="p">,</span> <span class="n">a_dict</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="extracaoDados.seleciona_ESTDFIMT" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">seleciona_ESTDFIMT</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

      <p>Elimina os valores invalidos ou nulos de ESTDFIMT. .</p>


<details class="regras" open>
  <summary>Regras</summary>
  <p>ESTDFIMT ==&gt;&gt; Variável ESTDFIMT = 8. Não se aplica; 9. Sem informação  ===&gt;&gt;&gt; ELIMINAR</p>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>df</code></td>
            <td>
                  <code>DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame a ser transformado / analisado</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>df modificado</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>Dictionary</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict com indicadores</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>extracaoDados.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">seleciona_ESTDFIMT</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Elimina os valores invalidos ou nulos de ESTDFIMT. .</span>

<span class="sd">    Regras:</span>
<span class="sd">        ESTDFIMT ==&gt;&gt; Variável ESTDFIMT = 8. Não se aplica; 9. Sem informação  ===&gt;&gt;&gt; ELIMINAR</span>

<span class="sd">    Parameters:</span>
<span class="sd">        df (DataFrame): DataFrame a ser transformado / analisado</span>

<span class="sd">    Returns:</span>
<span class="sd">        (DataFrame): df modificado</span>
<span class="sd">        (Dictionary):  dict com indicadores</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">q_inicial</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1">#retirar valores 8 e 9</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ESTDFIMT&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;8&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ESTDFIMT&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;9&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
    <span class="c1">#retirar valores null</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ESTDFIMT&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">a_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">a_dict</span><span class="p">[</span><span class="s1">&#39;ESTDFIMT&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">q_inicial</span> <span class="o">-</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">log</span><span class="o">.</span><span class="n">logar_acao_realizada</span><span class="p">(</span><span class="s1">&#39;Selecao Dados&#39;</span> <span class="p">,</span> <span class="s1">&#39;Eliminacao de registros com ESTDFIMT invalido (8 , 9 e nulos)&#39;</span> <span class="p">,</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">q_inicial</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">))</span>
    <span class="n">log</span><span class="o">.</span><span class="n">logar_indicador</span><span class="p">(</span><span class="s1">&#39;Extracao&#39;</span> <span class="p">,</span> <span class="s1">&#39;Eliminar Dados&#39;</span>  <span class="p">,</span> <span class="s1">&#39;Eliminacao de registros com ESTDFIMT invalido (8 , 9 e nulos)&#39;</span> <span class="p">,</span> <span class="s1">&#39;ESTDFIMT&#39;</span> <span class="p">,</span> <span class="n">q_inicial</span> <span class="o">-</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span>


    <span class="k">return</span> <span class="n">df</span> <span class="p">,</span> <span class="n">a_dict</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="extracaoDados.seleciona_TNM" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">seleciona_TNM</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

      <p>Elimina os valores invalidos ou nulos de TNM. .</p>
<p>TNM   <AnaliseTNM></p>


<details class="regras" open>
  <summary>Regras</summary>
  <p>AnaliseTNM ==&gt;&gt; invalido | demais  ===&gt;&gt;&gt; ELIMINAR
Analisar o que deve ser feito com &lt; nao se aplica - Hemato | nao se aplica - Geral&gt;</p>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>df</code></td>
            <td>
                  <code>DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame a ser transformado / analisado</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>df modificado</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>Dictionary</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict com indicadores</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>extracaoDados.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">seleciona_TNM</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Elimina os valores invalidos ou nulos de TNM. .</span>

<span class="sd">    TNM   &lt;AnaliseTNM&gt;</span>

<span class="sd">    Regras:</span>
<span class="sd">        AnaliseTNM ==&gt;&gt; invalido | demais  ===&gt;&gt;&gt; ELIMINAR</span>
<span class="sd">        Analisar o que deve ser feito com &lt; nao se aplica - Hemato | nao se aplica - Geral&gt;</span>

<span class="sd">    Parameters:</span>
<span class="sd">        df (DataFrame): DataFrame a ser transformado / analisado</span>


<span class="sd">    Returns:</span>
<span class="sd">        (DataFrame): df modificado</span>
<span class="sd">        (Dictionary):  dict com indicadores</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">q_inicial</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1">#retirar valores que nao sao exatos</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;AnaliseTNM&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;invalido&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;AnaliseTNM&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;demais&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;TNM&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">a_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">a_dict</span><span class="p">[</span><span class="s1">&#39;TNM&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">q_inicial</span> <span class="o">-</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">log</span><span class="o">.</span><span class="n">logar_acao_realizada</span><span class="p">(</span><span class="s1">&#39;Selecao Dados&#39;</span> <span class="p">,</span> <span class="s1">&#39;Eliminacao de registros com TNM  nulos ou que nao sao exatos ou incompletos. </span><span class="se">\n</span><span class="s1">  Analisar o que deve ser feito com &lt; nao se aplica - Hemato | nao se aplica - Geral&gt;&#39;</span> <span class="p">,</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">q_inicial</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">))</span>
    <span class="n">log</span><span class="o">.</span><span class="n">logar_indicador</span><span class="p">(</span><span class="s1">&#39;Extracao&#39;</span> <span class="p">,</span> <span class="s1">&#39;Eliminar Dados&#39;</span>  <span class="p">,</span> <span class="s1">&#39;Eliminacao de registros com TNM  nulos ou que nao sao exatos ou incompletos&#39;</span> <span class="p">,</span> <span class="s1">&#39;TNM&#39;</span> <span class="p">,</span> <span class="n">q_inicial</span> <span class="o">-</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span>

    <span class="k">return</span> <span class="n">df</span> <span class="p">,</span> <span class="n">a_dict</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="extracaoDados.seleciona_naonulos" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">seleciona_naonulos</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">lista_variaveis</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

      <p>Elimina os valores nulos das variaveis passadas como parametros.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>df</code></td>
            <td>
                  <code>DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame a ser transformado / analisado</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>lista_variaveis</code></td>
            <td>
                  <code>list</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>variaveis cujos valores nulos serão removidos</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>df modificado</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>Dictionary</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict com indicadores</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>extracaoDados.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">seleciona_naonulos</span><span class="p">(</span><span class="n">df</span> <span class="p">,</span> <span class="n">lista_variaveis</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Elimina os valores nulos das variaveis passadas como parametros.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        df (DataFrame): DataFrame a ser transformado / analisado</span>
<span class="sd">        lista_variaveis (list): variaveis cujos valores nulos serão removidos</span>


<span class="sd">    Returns:</span>
<span class="sd">        (DataFrame): df modificado</span>
<span class="sd">        (Dictionary):  dict com indicadores</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">q_base</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>



    <span class="n">a</span> <span class="o">=</span> <span class="n">df_base</span><span class="p">[</span><span class="n">lista_variaveis</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int64&#39;</span><span class="p">)</span>

    <span class="n">a_dict</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">a_var</span> <span class="ow">in</span> <span class="n">lista_variaveis</span><span class="p">:</span>
        <span class="n">q_inicial</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span> <span class="o">=</span> <span class="p">[</span><span class="n">a_var</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">log</span><span class="o">.</span><span class="n">logar_indicador</span><span class="p">(</span><span class="s1">&#39;Extracao&#39;</span> <span class="p">,</span> <span class="s1">&#39;Eliminar Dados&#39;</span>  <span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Eliminacao de registros com </span><span class="si">{</span><span class="n">a_var</span><span class="si">}</span><span class="s1"> nulo&#39;</span> <span class="p">,</span> <span class="n">a_var</span><span class="p">,</span> <span class="n">q_inicial</span> <span class="o">-</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">log</span><span class="o">.</span><span class="n">logar_acao_realizada</span><span class="p">(</span><span class="s1">&#39;Selecao Dados&#39;</span> <span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Eliminacao dos registros </span><span class="si">{</span><span class="n">lista_variaveis</span><span class="si">}</span><span class="s1"> com valores nulos&#39;</span> <span class="p">,</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">q_base</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">df</span> <span class="p">,</span> <span class="n">a_dict</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.ad660dcc.min.js"></script>
      
    
  </body>
</html>