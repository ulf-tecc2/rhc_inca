
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../funcoes_ext/">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.27">
    
    
      
        <title>Geracao de Indicadores - Registros Hospitalares de Câncer (RHC)</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.6543a935.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#gerar_indicadores" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Registros Hospitalares de Câncer (RHC)" class="md-header__button md-logo" aria-label="Registros Hospitalares de Câncer (RHC)" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Registros Hospitalares de Câncer (RHC)
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Geracao de Indicadores
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
      <div class="md-header__source">
        <a href="https://github.com/ulf-tecc2/rhc_inca.git" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Registros Hospitalares de Câncer (RHC)" class="md-nav__button md-logo" aria-label="Registros Hospitalares de Câncer (RHC)" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Registros Hospitalares de Câncer (RHC)
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ulf-tecc2/rhc_inca.git" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../funcoes_pre/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pre Processamento e Carga de Dados
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../funcoes_ana/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Analise de Dados
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../transformacoes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transformacoes dos Dados
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../funcoes_ext/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Extracao e Selecao de Dados
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Geracao de Indicadores
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Geracao de Indicadores
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#gerar_indicadores" class="md-nav__link">
    <span class="md-ellipsis">
      gerar_indicadores
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gerar_indicadores--roteiro-de-execucao" class="md-nav__link">
    <span class="md-ellipsis">
      Roteiro de execucao:
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gerar_indicadores.busca_data_sp_iniciou_mais_que_1_trat" class="md-nav__link">
    <span class="md-ellipsis">
      busca_data_sp_iniciou_mais_que_1_trat
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gerar_indicadores.gera_indicador_incompletude" class="md-nav__link">
    <span class="md-ellipsis">
      gera_indicador_incompletude
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gerar_indicadores.insere_indicador_invalidos" class="md-nav__link">
    <span class="md-ellipsis">
      insere_indicador_invalidos
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gerar_indicadores.insere_indicador_nulos" class="md-nav__link">
    <span class="md-ellipsis">
      insere_indicador_nulos
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gerar_indicadores.main_indicadores_globais" class="md-nav__link">
    <span class="md-ellipsis">
      main_indicadores_globais
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gerar_indicadores.main_indicadores_variaveis" class="md-nav__link">
    <span class="md-ellipsis">
      main_indicadores_variaveis
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#gerar_indicadores" class="md-nav__link">
    <span class="md-ellipsis">
      gerar_indicadores
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gerar_indicadores--roteiro-de-execucao" class="md-nav__link">
    <span class="md-ellipsis">
      Roteiro de execucao:
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gerar_indicadores.busca_data_sp_iniciou_mais_que_1_trat" class="md-nav__link">
    <span class="md-ellipsis">
      busca_data_sp_iniciou_mais_que_1_trat
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gerar_indicadores.gera_indicador_incompletude" class="md-nav__link">
    <span class="md-ellipsis">
      gera_indicador_incompletude
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gerar_indicadores.insere_indicador_invalidos" class="md-nav__link">
    <span class="md-ellipsis">
      insere_indicador_invalidos
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gerar_indicadores.insere_indicador_nulos" class="md-nav__link">
    <span class="md-ellipsis">
      insere_indicador_nulos
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gerar_indicadores.main_indicadores_globais" class="md-nav__link">
    <span class="md-ellipsis">
      main_indicadores_globais
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gerar_indicadores.main_indicadores_variaveis" class="md-nav__link">
    <span class="md-ellipsis">
      main_indicadores_variaveis
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>Geracao de Indicadores</h1>

<div class="doc doc-object doc-module">



<a id="gerar_indicadores"></a>
    <div class="doc doc-contents first">

      <p>Registros Hospitalares de Câncer (RHC) - Carregamento e consolidacao inicial dos dados.</p>
<p>MBA em Data Science e Analytics - USP/Esalq - 2025</p>
<p>@author: ulf Bergmann</p>
<h2 id="gerar_indicadores--roteiro-de-execucao">Roteiro de execucao:</h2>
<pre><code>1. Identifica valores nulos por variavel na Base de Dados inicial 
2. Identifica valores nulos por variavel apos definicao dos tipos
3. Identifica valores nulos por variavel apos analise dos dados
4. Identifica valores invalidos por variavel apos analise dos dados
5. Registra registros removidos na seleção da base
6. Salvar o arquivo de indicadores
</code></pre>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="gerar_indicadores.busca_data_sp_iniciou_mais_que_1_trat" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">busca_data_sp_iniciou_mais_que_1_trat</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

      <p>Identifica a data de quando SP iniciou o registro de mais de um tratamento.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>df</code></td>
            <td>
                  <code>DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame a ser pesquisado</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>Date</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>data do inicio</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>gerar_indicadores.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">busca_data_sp_iniciou_mais_que_1_trat</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Identifica a data de quando SP iniciou o registro de mais de um tratamento.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        df (DataFrame): DataFrame a ser pesquisado</span>

<span class="sd">    Returns:</span>
<span class="sd">        (Date):  data do inicio</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="n">aux_sp</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;UFUH&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;SP&#39;</span><span class="p">]</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">aux_sp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">aux_sp</span><span class="p">[</span><span class="s1">&#39;PRITRATH_NrTratamentos&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">a</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;DATAINITRT&#39;</span> <span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">return</span>  <span class="n">a</span><span class="p">[</span><span class="s1">&#39;DATAINITRT&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="gerar_indicadores.gera_indicador_incompletude" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">gera_indicador_incompletude</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">etapa</span><span class="p">,</span> <span class="n">lista_colunas</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

      <p>Gera o indicador de INCOMPLETUDE para cada variavel do DataFrame.</p>
<p>Incompletitude: proporção de informação ignorada, ou seja, os campos em branco e os códigos atribuídos à informação ignorada</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>df</code></td>
            <td>
                  <code>DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame a ser analisado</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>etapa</code></td>
            <td>
                  <code>String</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>momento do calculo do indicador</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>lista_colunas</code></td>
            <td>
                  <code>String</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>colunas a serem analisadas</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>response</code></td>
            <td>
                  <code>DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame com indicadores</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame com indicador de Incompletude</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>gerar_indicadores.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">gera_indicador_incompletude</span><span class="p">(</span><span class="n">df</span> <span class="p">,</span> <span class="n">etapa</span> <span class="p">,</span> <span class="n">lista_colunas</span> <span class="p">,</span> <span class="n">response</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gera o indicador de INCOMPLETUDE para cada variavel do DataFrame.</span>

<span class="sd">    Incompletitude: proporção de informação ignorada, ou seja, os campos em branco e os códigos atribuídos à informação ignorada</span>

<span class="sd">    Parameters:</span>
<span class="sd">        df (DataFrame): DataFrame a ser analisado</span>
<span class="sd">        etapa (String): momento do calculo do indicador</span>
<span class="sd">        lista_colunas (String):  colunas a serem analisadas</span>
<span class="sd">        response (DataFrame): DataFrame com indicadores</span>

<span class="sd">    Returns:</span>
<span class="sd">        (DataFrame):  DataFrame com indicador de Incompletude</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">informacao_ignorada</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;ALCOOLIS&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;9&#39;</span><span class="p">]</span> <span class="p">,</span>
        <span class="s1">&#39;BASDIAGSP&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;4&#39;</span><span class="p">]</span> <span class="p">,</span>
        <span class="s1">&#39;BASMAIMP&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;9&#39;</span><span class="p">]</span> <span class="p">,</span>
        <span class="s1">&#39;DIAGANT&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;9&#39;</span><span class="p">]</span> <span class="p">,</span>
        <span class="s1">&#39;ESTCONJ&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;9&#39;</span><span class="p">]</span> <span class="p">,</span>
        <span class="s1">&#39;ESTDFIMT&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;9&#39;</span><span class="p">]</span> <span class="p">,</span>
        <span class="s1">&#39;EXDIAG&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;9&#39;</span><span class="p">]</span> <span class="p">,</span>
        <span class="s1">&#39;HISTFAMC&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;9&#39;</span><span class="p">]</span> <span class="p">,</span>
        <span class="s1">&#39;INSTRUC&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;9&#39;</span><span class="p">]</span> <span class="p">,</span>
        <span class="s1">&#39;LATERALI&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;9&#39;</span><span class="p">]</span> <span class="p">,</span>
        <span class="s1">&#39;OCUPACAO&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;999&#39;</span> <span class="p">,</span> <span class="s1">&#39;9999&#39;</span><span class="p">]</span> <span class="p">,</span>
        <span class="s1">&#39;ORIENC&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;9&#39;</span><span class="p">]</span> <span class="p">,</span>
        <span class="s1">&#39;PRITRATH&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;9&#39;</span><span class="p">]</span> <span class="p">,</span>
        <span class="s1">&#39;PTNM&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;9&#39;</span><span class="p">]</span> <span class="p">,</span>
        <span class="s1">&#39;RACACOR&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;9&#39;</span><span class="p">]</span> <span class="p">,</span>
        <span class="s1">&#39;RZNTR&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;9&#39;</span><span class="p">]</span> <span class="p">,</span>
        <span class="s1">&#39;TABAGISM&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;9&#39;</span><span class="p">]</span> 
        <span class="p">}</span>

    <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">lista_colunas</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">dropna</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
        <span class="n">count_nulos</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">count_sem_info</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">a</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
            <span class="c1"># print((var in informacao_ignorada_por_atributo.keys()) and (row[var] in informacao_ignorada_por_atributo[var] ))</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;nan&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
                <span class="c1"># print(f&#39; nan -&gt; {var} count -&gt; {row.iloc[1]}&#39;)</span>
                <span class="n">count_nulos</span> <span class="o">=</span> <span class="n">count_nulos</span> <span class="o">+</span> <span class="n">row</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">((</span><span class="n">var</span> <span class="ow">in</span> <span class="n">informacao_ignorada</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="ow">in</span> <span class="n">informacao_ignorada</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="p">)):</span>
                    <span class="n">count_sem_info</span> <span class="o">=</span> <span class="n">count_sem_info</span> <span class="o">+</span> <span class="n">row</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">response</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">etapa</span> <span class="o">+</span> <span class="s1">&#39; - Nr incompletos (nulos)&#39;</span> <span class="p">,</span> <span class="n">var</span><span class="p">]</span> <span class="o">=</span> <span class="n">count_nulos</span>
        <span class="n">response</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">etapa</span> <span class="o">+</span> <span class="n">etapa</span> <span class="o">+</span> <span class="s1">&#39; - </span><span class="si">% i</span><span class="s1">ncompletos (nulos)&#39;</span> <span class="p">,</span> <span class="n">var</span><span class="p">]</span> <span class="o">=</span> <span class="n">count_nulos</span> <span class="o">*</span> <span class="mi">100</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

        <span class="n">response</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">etapa</span> <span class="o">+</span> <span class="s1">&#39; - Nr incompletos (sem info)&#39;</span> <span class="p">,</span> <span class="n">var</span><span class="p">]</span> <span class="o">=</span> <span class="n">count_sem_info</span>
        <span class="n">response</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">etapa</span> <span class="o">+</span> <span class="n">etapa</span> <span class="o">+</span> <span class="s1">&#39; - </span><span class="si">% i</span><span class="s1">ncompletos (sem info)&#39;</span> <span class="p">,</span> <span class="n">var</span><span class="p">]</span> <span class="o">=</span> <span class="n">count_sem_info</span> <span class="o">*</span> <span class="mi">100</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>



    <span class="k">return</span> <span class="n">response</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="gerar_indicadores.insere_indicador_invalidos" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">insere_indicador_invalidos</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

      <p>Gera o indicador de registros invalidos para cada variavel do DataFrame.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>df</code></td>
            <td>
                  <code>DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame a ser analisado</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>response</code></td>
            <td>
                  <code>DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame com indicadores</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame com indicadores atualizados</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>gerar_indicadores.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">insere_indicador_invalidos</span><span class="p">(</span><span class="n">df</span> <span class="p">,</span> <span class="n">response</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gera o indicador de registros invalidos para cada variavel do DataFrame.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        df (DataFrame): DataFrame a ser analisado</span>
<span class="sd">        response (DataFrame): DataFrame com indicadores</span>

<span class="sd">    Returns:</span>
<span class="sd">        (DataFrame):  DataFrame com indicadores atualizados</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">q_TNM</span> <span class="o">=</span> <span class="n">df_apos_analise</span><span class="p">[(</span><span class="n">df_apos_analise</span><span class="p">[</span><span class="s1">&#39;AnaliseTNM&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;incompleto&#39;</span><span class="p">)</span> <span class="o">|</span>
                                    <span class="p">(</span><span class="n">df_apos_analise</span><span class="p">[</span><span class="s1">&#39;AnaliseTNM&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;demais&#39;</span><span class="p">)</span> <span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">q_LOCTUDET</span> <span class="o">=</span> <span class="n">df_apos_analise</span><span class="p">[(</span><span class="n">df_apos_analise</span><span class="p">[</span><span class="s1">&#39;AnaliseLOCTUDET&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;incompleto&#39;</span><span class="p">)</span> <span class="o">|</span>
                                    <span class="p">(</span><span class="n">df_apos_analise</span><span class="p">[</span><span class="s1">&#39;AnaliseLOCTUDET&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;demais&#39;</span><span class="p">)</span> <span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">q_LOCTUPRI</span> <span class="o">=</span> <span class="n">df_apos_analise</span><span class="p">[(</span><span class="n">df_apos_analise</span><span class="p">[</span><span class="s1">&#39;AnaliseLOCTUPRI&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;incompleto&#39;</span><span class="p">)</span> <span class="o">|</span>
                                    <span class="p">(</span><span class="n">df_apos_analise</span><span class="p">[</span><span class="s1">&#39;AnaliseLOCTUPRI&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;demais&#39;</span><span class="p">)</span> <span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">q_LOCTUPRO</span> <span class="o">=</span> <span class="n">df_apos_analise</span><span class="p">[(</span><span class="n">df_apos_analise</span><span class="p">[</span><span class="s1">&#39;AnaliseLOCTUPRO&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;incompleto&#39;</span><span class="p">)</span> <span class="o">|</span>
                                    <span class="p">(</span><span class="n">df_apos_analise</span><span class="p">[</span><span class="s1">&#39;AnaliseLOCTUPRO&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;demais&#39;</span><span class="p">)</span> <span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">q_ESTADIAM</span> <span class="o">=</span> <span class="n">df_apos_analise</span><span class="p">[(</span><span class="n">df_apos_analise</span><span class="p">[</span><span class="s1">&#39;AnaliseESTADIAM&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;incompleto&#39;</span><span class="p">)</span> <span class="o">|</span>
                                    <span class="p">(</span><span class="n">df_apos_analise</span><span class="p">[</span><span class="s1">&#39;AnaliseESTADIAM&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;demais&#39;</span><span class="p">)</span> <span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">q_IDADE</span> <span class="o">=</span> <span class="n">df_apos_analise</span><span class="p">[</span><span class="n">df_apos_analise</span><span class="p">[</span><span class="s1">&#39;IDADE&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>



    <span class="c1"># a_df = pd.DataFrame([a_dict])</span>
    <span class="c1"># a_df.insert(0, &quot;Indicador&quot;, [&#39;Invalidos apos analise&#39;])</span>

    <span class="n">response</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s1">&#39;Invalidos apos a Analise&#39;</span> <span class="p">,</span> <span class="s1">&#39;TNM&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">q_TNM</span>
    <span class="n">response</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s1">&#39;Invalidos apos a Analise&#39;</span> <span class="p">,</span> <span class="s1">&#39;LOCTUDET&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">q_LOCTUDET</span>
    <span class="n">response</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s1">&#39;Invalidos apos a Analise&#39;</span> <span class="p">,</span> <span class="s1">&#39;LOCTUPRI&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">q_LOCTUPRI</span>
    <span class="n">response</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s1">&#39;Invalidos apos a Analise&#39;</span> <span class="p">,</span> <span class="s1">&#39;LOCTUPRO&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">q_LOCTUPRO</span>
    <span class="n">response</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s1">&#39;Invalidos apos a Analise&#39;</span> <span class="p">,</span> <span class="s1">&#39;ESTADIAM&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">q_ESTADIAM</span>
    <span class="n">response</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s1">&#39;Invalidos apos a Analise&#39;</span> <span class="p">,</span> <span class="s1">&#39;IDADE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">q_IDADE</span>


    <span class="k">return</span> <span class="n">response</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="gerar_indicadores.insere_indicador_nulos" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">insere_indicador_nulos</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">tipo</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

      <p>Gera o indicador de registros nulos para cada variavel do DataFrame.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>df</code></td>
            <td>
                  <code>DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame a ser analisado</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>tipo</code></td>
            <td>
                  <code>String</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>tipo do df / indicador</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>response</code></td>
            <td>
                  <code>DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame com indicadores</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame com indicadores atualizados</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>gerar_indicadores.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">insere_indicador_nulos</span><span class="p">(</span><span class="n">df</span> <span class="p">,</span> <span class="n">tipo</span> <span class="p">,</span> <span class="n">response</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gera o indicador de registros nulos para cada variavel do DataFrame.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        df (DataFrame): DataFrame a ser analisado</span>
<span class="sd">        tipo (String): tipo do df / indicador</span>
<span class="sd">        response (DataFrame): DataFrame com indicadores</span>

<span class="sd">    Returns:</span>
<span class="sd">        (DataFrame): DataFrame com indicadores atualizados</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int64&#39;</span><span class="p">)</span>   
    <span class="n">a_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>  
    <span class="n">a_df</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Indicador&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">tipo</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">response</span> <span class="p">,</span> <span class="n">a_df</span><span class="p">]</span> <span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="gerar_indicadores.main_indicadores_globais" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">main_indicadores_globais</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

      <p>Funcao principal de geracao dos indicadores globais.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame com indicadores globais</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>gerar_indicadores.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">main_indicadores_globais</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Funcao principal de geracao dos indicadores globais.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (DataFrame):  DataFrame com indicadores globais       </span>
<span class="sd">    &quot;&quot;&quot;</span>     
    <span class="n">a_lista</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">a_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Indicador&#39;</span> <span class="p">:</span> <span class="s1">&#39;Quantidade de Registros&#39;</span> <span class="p">,</span>
             <span class="s1">&#39;Etapa&#39;</span> <span class="p">:</span> <span class="s1">&#39;Carga Inicial - Dados Brutos&#39;</span> <span class="p">,</span>
             <span class="s1">&#39;Valor&#39;</span> <span class="p">:</span> <span class="n">df_inicial</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
             <span class="p">}</span>
    <span class="n">a_lista</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a_dict</span><span class="p">)</span>

    <span class="n">a_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Indicador&#39;</span> <span class="p">:</span> <span class="s1">&#39;Quantidade de Registros&#39;</span> <span class="p">,</span>
             <span class="s1">&#39;Etapa&#39;</span> <span class="p">:</span> <span class="s1">&#39;Final da Analise - Dados Completos&#39;</span> <span class="p">,</span>
             <span class="s1">&#39;Valor&#39;</span> <span class="p">:</span> <span class="n">df_apos_analise</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
             <span class="p">}</span>
    <span class="n">a_lista</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a_dict</span><span class="p">)</span>

    <span class="n">a_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Indicador&#39;</span> <span class="p">:</span> <span class="s1">&#39;Quantidade de Registros&#39;</span> <span class="p">,</span>
             <span class="s1">&#39;Etapa&#39;</span> <span class="p">:</span> <span class="s1">&#39;Extracao - Dados de Casos Analiticos&#39;</span> <span class="p">,</span>
             <span class="s1">&#39;Valor&#39;</span> <span class="p">:</span> <span class="n">df_apos_extracao</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
             <span class="p">}</span>
    <span class="n">a_lista</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a_dict</span><span class="p">)</span>

    <span class="n">data_sp</span> <span class="o">=</span> <span class="n">busca_data_sp_iniciou_mais_que_1_trat</span><span class="p">(</span><span class="n">df_apos_transf</span><span class="p">)</span>

    <span class="n">a_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Indicador&#39;</span> <span class="p">:</span> <span class="s1">&#39;Data de Inicio de mais de um trat em SP&#39;</span> <span class="p">,</span>
             <span class="s1">&#39;Etapa&#39;</span> <span class="p">:</span> <span class="s1">&#39;Final da Analise - Dados Completos&#39;</span> <span class="p">,</span>
             <span class="s1">&#39;Valor&#39;</span> <span class="p">:</span> <span class="n">data_sp</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%m/%Y&#39;</span><span class="p">)</span>
             <span class="p">}</span>
    <span class="n">a_lista</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a_dict</span><span class="p">)</span>

    <span class="n">a_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">a_lista</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">a_df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="gerar_indicadores.main_indicadores_variaveis" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">main_indicadores_variaveis</span><span class="p">(</span><span class="n">response_df</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

      <p>Funcao principal de geracao dos indicadores das variaveis.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>response_df</code></td>
            <td>
                  <code>DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame com indicadores</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
      <p>Returns:
    (DataFrame):  DataFrame com indicadores atualizados</p>

            <details class="quote">
              <summary>Source code in <code>gerar_indicadores.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">main_indicadores_variaveis</span><span class="p">(</span><span class="n">response_df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Funcao principal de geracao dos indicadores das variaveis.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        response_df (DataFrame): DataFrame com indicadores</span>
<span class="sd">    Returns:</span>
<span class="sd">        (DataFrame):  DataFrame com indicadores atualizados       </span>
<span class="sd">    &quot;&quot;&quot;</span> 
    <span class="c1"># response_df = insere_indicador_nulos(df = df_inicial, tipo = &#39;Nulos - Inicial&#39; , response = response_df)</span>

    <span class="c1"># response_df = insere_indicador_nulos(df = df_apos_tipos, tipo = &#39;Nulos - Após Tipos Definidos&#39;, response = response_df)</span>

    <span class="c1"># response_df = insere_indicador_nulos(df = df_apos_analise, tipo = &#39;Nulos - Após Analise dos Dados&#39;, response = response_df)</span>

    <span class="c1"># print(log.logar_acao_realizada(&#39;Indicadores&#39; , &#39;Calculo dos indicadores de NULOS&#39; , &#39; &#39;))</span>

    <span class="n">response_df</span> <span class="o">=</span> <span class="n">gera_indicador_incompletude</span><span class="p">(</span><span class="n">df_inicial</span> <span class="p">,</span> <span class="s1">&#39;Inicial&#39;</span> <span class="p">,</span> <span class="n">df_inicial</span><span class="o">.</span><span class="n">columns</span> <span class="p">,</span> <span class="n">response_df</span> <span class="p">)</span>
    <span class="n">response_df</span> <span class="o">=</span> <span class="n">gera_indicador_incompletude</span><span class="p">(</span><span class="n">df_apos_tipos</span> <span class="p">,</span> <span class="s1">&#39;Apos Tipos definidos&#39;</span> <span class="p">,</span> <span class="n">df_apos_tipos</span><span class="o">.</span><span class="n">columns</span> <span class="p">,</span> <span class="n">response_df</span> <span class="p">)</span>
    <span class="n">response_df</span> <span class="o">=</span> <span class="n">gera_indicador_incompletude</span><span class="p">(</span><span class="n">df_apos_analise</span> <span class="p">,</span> <span class="s1">&#39;Após Analise dos Dados&#39;</span> <span class="p">,</span> <span class="n">df_apos_analise</span><span class="o">.</span><span class="n">columns</span> <span class="p">,</span> <span class="n">response_df</span> <span class="p">)</span>
    <span class="n">response_df</span> <span class="o">=</span> <span class="n">gera_indicador_incompletude</span><span class="p">(</span><span class="n">df_apos_transf</span> <span class="p">,</span> <span class="s1">&#39;Apos Transformacoes&#39;</span> <span class="p">,</span> <span class="n">df_apos_transf</span><span class="o">.</span><span class="n">columns</span> <span class="p">,</span> <span class="n">response_df</span> <span class="p">)</span>
    <span class="n">response_df</span> <span class="o">=</span> <span class="n">gera_indicador_incompletude</span><span class="p">(</span><span class="n">df_apos_extracao</span> <span class="p">,</span> <span class="s1">&#39;Apos Extracao&#39;</span> <span class="p">,</span> <span class="n">df_apos_extracao</span><span class="o">.</span><span class="n">columns</span> <span class="p">,</span> <span class="n">response_df</span> <span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">log</span><span class="o">.</span><span class="n">logar_acao_realizada</span><span class="p">(</span><span class="s1">&#39;Indicadores&#39;</span> <span class="p">,</span> <span class="s1">&#39;Calculo dos indicadores de COMPLETUDE (porcentagem de nulos ou sem informação)&#39;</span> <span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">))</span>


    <span class="n">response_df</span> <span class="o">=</span> <span class="n">insere_indicador_invalidos</span><span class="p">(</span><span class="n">df</span> <span class="o">=</span> <span class="n">df_apos_analise</span><span class="p">,</span> <span class="n">response</span> <span class="o">=</span> <span class="n">response_df</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">log</span><span class="o">.</span><span class="n">logar_acao_realizada</span><span class="p">(</span><span class="s1">&#39;Indicadores&#39;</span> <span class="p">,</span> <span class="s1">&#39;Calculo dos indicadores de INVALIDOS&#39;</span> <span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">))</span>


    <span class="k">return</span> <span class="n">response_df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.ad660dcc.min.js"></script>
      
    
  </body>
</html>